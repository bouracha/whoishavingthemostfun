<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login - Who's Having The Most Fun?</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; display:flex; align-items:center; justify-content:center; height:100vh; margin:0 }
    .card { background:#fff; padding:28px; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.1); width:320px }
    h2 { margin:0 0 16px 0; font-size:20px; text-align:center }
    label { display:block; font-size:13px; margin:10px 0 6px; color:#555 }
    input { width:100%; padding:10px; border:1px solid #ddd; border-radius:8px; box-sizing:border-box }
    button { width:100%; margin-top:16px; padding:12px; border:none; border-radius:8px; background:#2196F3; color:#fff; font-weight:bold; cursor:pointer }
    button:hover { background:#1976D2 }
    .msg { margin-top:12px; display:none; padding:10px; border-radius:8px; font-size:13px }
    .error { background:#fdecea; color:#b71c1c; border:1px solid #f5c6cb }
  </style>
</head>
<body>
  <div class="card">
    <h2>Team Login</h2>
    <label for="team">Team name</label>
    <input id="team" placeholder="e.g. bourached" />
    <label for="password">Password</label>
    <input id="password" type="password" placeholder="Password" />
    <button onclick="login()">Login</button>
    <div id="msg" class="msg error"></div>
  </div>
  <script>
    async function login() {
      const team = document.getElementById('team').value.trim().toLowerCase();
      const password = document.getElementById('password').value;
      const msg = document.getElementById('msg');
      msg.style.display = 'none';
      if (!team || !password) { msg.textContent = 'Enter team and password'; msg.style.display = 'block'; return; }
      const isLocal = location.hostname === 'localhost' || location.hostname === '127.0.0.1';
      const url = isLocal ? 'http://localhost:8080/api/auth/login' : '/api/auth/login';
      try {
        const res = await fetch(url, { method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body: JSON.stringify({ team, password }) });
        const data = await res.json();
        if (!res.ok) { throw new Error(data.error || 'Login failed'); }
        // Redirect to team home
        location.href = `/t/${team}`;
      } catch (e) {
        msg.textContent = e.message;
        msg.style.display = 'block';
      }
    }
  </script>
</body>
</html>

